{% extends "base.html" %}
{% block content %}

<h2 class="section-title white">Dashboard Overview</h2>

<!-- Stats Cards -->
<div class="stats-grid">
    <div class="stat-card">
        <p class="stat-value">â‚¬{{ total_monthly_cost }}</p>
        <p class="stat-label">Monthly Cost</p>
    </div>

    <div class="stat-card">
        <p class="stat-value">{{ sub_count }}</p>
        <p class="stat-label">Active Subscriptions</p>
    </div>
</div>


<!-- Annual Cost -->
<hr class="sep">
<h3 class="section-title white">Cost Projection</h3>
<p style="color:#cfa93e;font-size:20px;font-weight:600;">
    Annual Cost: â‚¬{{ annual_cost }}
</p>

<!-- Next Payments -->
<hr class="sep">
<h3 class="section-title white">Next Payments</h3>

{% if subs %}
<ul class="sub-list">
    {% for s in subs|sort(attribute='next_payment_date') %}
    <li class="sub-item">
        <strong>{{ s.name }}</strong> â€” {{ s.next_payment_date }}
        <span class="sub-meta">
            â‚¬{{ "%.2f"|format(s.price) }} / {{ s.billing_cycle }}
        </span>
    </li>
    {% endfor %}
</ul>
{% else %}
<p>No upcoming payments yet.</p>
{% endif %}


<!-- Categories Breakdown -->
<hr class="sep">
<h3 class="section-title white">Categories Overview</h3>

{% if categories %}
<ul class="sub-list">
    {% for cat, count in categories.items() %}
    <li class="sub-item">
        {{ cat }}:
        {% for i in range(count) %}
            <span style="color:#cfa93e;">â–ˆ</span>
        {% endfor %}
        <small>({{ count }})</small>
    </li>
    {% endfor %}
</ul>

{% if top_category %}
<p style="margin-top:12px;">
    ðŸ”¥ Most Subscribed Category:
    <strong style="color:#cfa93e;">{{ top_category }}</strong>
</p>
{% endif %}

{% else %}
<p>No categories yet.</p>
{% endif %}


<!-- Call To Action -->
<div style="text-align:center; margin-top: 40px;">
    <a href="{{ url_for('subscriptions') }}" class="btn-primary">
        Manage Subscriptions
    </a>
</div>

{% endblock %}